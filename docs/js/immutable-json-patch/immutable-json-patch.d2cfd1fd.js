function g(e){return Array.isArray(e)}function h(e){return e!==null&&typeof e=="object"&&e.constructor===Object}function H(e){return e&&typeof e=="object"?e.op==="add":!1}function K(e){return e&&typeof e=="object"?e.op==="remove":!1}function L(e){return e&&typeof e=="object"?e.op==="replace":!1}function Q(e){return e&&typeof e=="object"?e.op==="copy":!1}function Y(e){return e&&typeof e=="object"?e.op==="move":!1}function k(e,r){return JSON.stringify(e)===JSON.stringify(r)}function T(e,r){return e===r}function m(e){return e.slice(0,e.length-1)}function q(e){return e[e.length-1]}function D(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:T;if(e.length<r.length)return!1;for(let t=0;t<r.length;t++)if(!n(e[t],r[t]))return!1;return!0}function E(e){return typeof e=="object"&&e!==null}function S(e){if(g(e)){const r=e.slice();return Object.getOwnPropertySymbols(e).forEach(n=>{r[n]=e[n]}),r}else if(h(e)){const r={...e};return Object.getOwnPropertySymbols(e).forEach(n=>{r[n]=e[n]}),r}else return e}function J(e,r,n){if(e[r]===n)return e;{const t=S(e);return t[r]=n,t}}function a(e,r){let n=e,t=0;for(;t<r.length;)h(n)?n=n[r[t]]:g(n)?n=n[parseInt(r[t])]:n=void 0,t++;return n}function p(e,r,n){let t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(r.length===0)return n;const o=r[0],i=p(e?e[o]:void 0,r.slice(1),n,t);if(h(e)||g(e))return J(e,o,i);if(t){const s=V.test(o)?[]:{};return s[o]=i,s}else throw new Error("Path does not exist")}const V=/^\d+$/;function v(e,r,n){if(r.length===0)return n(e);if(!E(e))throw new Error("Path doesn't exist");const t=r[0],o=v(e[t],r.slice(1),n);return J(e,t,o)}function N(e,r){if(r.length===0)return e;if(!E(e))throw new Error("Path does not exist");if(r.length===1){const o=r[0];if(o in e){const i=S(e);return g(i)&&i.splice(parseInt(o),1),h(i)&&delete i[o],i}else return e}const n=r[0],t=N(e[n],r.slice(1));return J(e,n,t)}function P(e,r,n){const t=r.slice(0,r.length-1),o=r[r.length-1];return v(e,t,i=>{if(!Array.isArray(i))throw new TypeError("Array expected at path "+JSON.stringify(t));const s=S(i);return s.splice(parseInt(o),0,n),s})}function y(e,r){return e===void 0?!1:r.length===0?!0:e===null?!1:y(e[r[0]],r.slice(1))}function A(e){const r=e.split("/");return r.shift(),r.map(n=>n.replace(/~1/g,"/").replace(/~0/g,"~"))}function c(e){return e.map(I).join("")}function I(e){return"/"+String(e).replace(/~/g,"~0").replace(/\//g,"~1")}function Z(e,r){return e+I(r)}function ee(e,r){return e.startsWith(r)&&(e.length===r.length||e[r.length]==="/")}function $(e,r,n){let t=e;for(let o=0;o<r.length;o++){X(r[o]);let i=r[o];if(n&&n.before){const u=n.before(t,i);if(u!==void 0){if(u.document!==void 0&&(t=u.document),u.json!==void 0)throw new Error('Deprecation warning: returned object property ".json" has been renamed to ".document"');u.operation!==void 0&&(i=u.operation)}}const s=t,f=b(t,i.path);if(i.op==="add")t=W(t,f,i.value);else if(i.op==="remove")t=U(t,f);else if(i.op==="replace")t=C(t,f,i.value);else if(i.op==="copy")t=G(t,f,w(i.from));else if(i.op==="move")t=M(t,f,w(i.from));else if(i.op==="test")_(t,f,i.value);else throw new Error("Unknown JSONPatch operation "+JSON.stringify(i));if(n&&n.after){const u=n.after(t,i,s);u!==void 0&&(t=u)}}return t}function C(e,r,n){return p(e,r,n)}function U(e,r){return N(e,r)}function W(e,r,n){return d(e,r)?P(e,r,n):p(e,r,n)}function G(e,r,n){const t=a(e,n);if(d(e,r))return P(e,r,t);{const o=a(e,n);return p(e,r,o)}}function M(e,r,n){const t=a(e,n),o=N(e,n);return d(o,r)?P(o,r,t):p(o,r,t)}function _(e,r,n){if(n===void 0)throw new Error(`Test failed: no value provided (path: "${c(r)}")`);if(!y(e,r))throw new Error(`Test failed: path not found (path: "${c(r)}")`);const t=a(e,r);if(!k(t,n))throw new Error(`Test failed, value differs (path: "${c(r)}")`)}function d(e,r){if(r.length===0)return!1;const n=a(e,m(r));return Array.isArray(n)}function F(e,r){if(q(r)!=="-")return r;const n=m(r),t=a(e,n);return n.concat(t.length)}function X(e){if(!["add","remove","replace","copy","move","test"].includes(e.op))throw new Error("Unknown JSONPatch op "+JSON.stringify(e.op));if(typeof e.path!="string")throw new Error('Required property "path" missing or not a string in operation '+JSON.stringify(e));if((e.op==="copy"||e.op==="move")&&typeof e.from!="string")throw new Error('Required property "from" missing or not a string in operation '+JSON.stringify(e))}function b(e,r){return F(e,A(r))}function w(e){return A(e)}function re(e,r,n){let t=[];return $(e,r,{before:(i,s)=>{let f;const u=b(i,s.path);if(s.op==="add")f=x(i,u);else if(s.op==="remove")f=j(i,u);else if(s.op==="replace")f=R(i,u);else if(s.op==="copy")f=z(i,u);else if(s.op==="move")f=B(i,u,w(s.from));else if(s.op==="test")f=[];else throw new Error("Unknown JSONPatch operation "+JSON.stringify(s));let O;if(n&&n.before){const l=n.before(i,s,f);if(l&&l.revertOperations&&(f=l.revertOperations),l&&l.document&&(O=l.document),l&&l.json)throw new Error('Deprecation warning: returned object property ".json" has been renamed to ".document"')}if(t=f.concat(t),O!==void 0)return{document:O}}}),t}function R(e,r){return[{op:"replace",path:c(r),value:a(e,r)}]}function j(e,r){return[{op:"add",path:c(r),value:a(e,r)}]}function x(e,r){return d(e,r)||!y(e,r)?[{op:"remove",path:c(r)}]:R(e,r)}function z(e,r){return x(e,r)}function B(e,r,n){if(r.length<n.length&&D(n,r))return[{op:"replace",path:c(r),value:e}];const t={op:"move",from:c(r),path:c(n)};return!d(e,r)&&y(e,r)?[t,...j(e,r)]:[t]}export{Z as a,g as b,c,$ as d,y as e,ee as f,a as g,H as h,h as i,L as j,b as k,K as l,Q as m,Y as n,A as p,re as r,p as s};
