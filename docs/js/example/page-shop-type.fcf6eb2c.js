import{u as z,t as O}from"../../assets/index-69b50686.js";import{I as A}from"../image-cutter-dialog/image-cutter-dialog.f52aa190.js";import{_ as F}from"../vue-img-cutter/vue-img-cutter.2bc658a8.js";import{r as u,i as P,ah as o,o as p,c as B,W as e,Q as t,a as N,U as n,V as H,u as $,bi as E,bg as L,j as M,ar as Q,R as G,P as y,F as J,T as q}from"../@vue/@vue.3dda84a1.js";import"../pinia/pinia.aa80a072.js";import"../vue-router/vue-router.3db44e60.js";import"../localforage/localforage.d1bba74f.js";import"../@kangc/@kangc.b905bff9.js";import"../vue/vue.0cda2ac5.js";import"../js-cookie/js-cookie.edb2da2a.js";import"../@tauri-apps/@tauri-apps.11f9d180.js";import"../axios/axios.47b9d439.js";import"../element-plus/element-plus.5a404924.js";import"../lodash-es/lodash-es.73b757c4.js";import"../@vueuse/@vueuse.6c9ad468.js";import"../@element-plus/@element-plus.e546425c.js";import"../@popperjs/@popperjs.c45de710.js";import"../@ctrl/@ctrl.f8748455.js";import"../dayjs/dayjs.3b8e0730.js";import"../async-validator/async-validator.7f96df71.js";import"../memoize-one/memoize-one.297ddbcb.js";import"../escape-html/escape-html.45073d95.js";import"../normalize-wheel-es/normalize-wheel-es.ed76fb12.js";import"../@floating-ui/@floating-ui.72671fae.js";import"../nprogress/nprogress.13f0dffc.js";import"../vue-i18n/vue-i18n.aff420db.js";import"../@intlify/@intlify.df011fbe.js";import"../highlight.js/highlight.js.d7f0f8ee.js";const K=m=>(E("data-v-14b62c72"),m=m(),L(),m),X={class:"vel_cpt_panel_dialog_add_shop_type"},Y=K(()=>N("p",null,"预览",-1)),Z={class:"dialog-footer"},ee="100px",te={__name:"add-shop-type-dialog",props:["dialog","paramData"],emits:["onConfirm"],setup(m,{emit:D}){const _=m,w=D,f=_.dialog,x=_.paramData,d=u({show:!1}),a=u({parent:{id:0,name:"无"},status:"0",sort:1,name:"",icon:""}),C=u(null);P(()=>{a.value=x});const k=()=>{d.value.show=!0},T=h=>{a.value.icon=h.dataURL},r=async()=>{try{await C.value.validate(),w("onConfirm",a.value),v()}catch{console.log("表单验证未通过")}},v=()=>{f.show=!1,a.value.parent.id=0,a.value.parent.name="无",a.value.name="",a.value.icon="",a.value.status="0",a.value.sort=1},g=u({name:[{required:!0,message:"分类名称不能为空！",trigger:"blur"},{min:2,max:10,message:"长度在 2 到 10 个字符",trigger:"blur"}],status:[{required:!0,message:"请选择状态",trigger:"change"}],sort:[{required:!0,message:"请输入排序",trigger:"blur"}]});return(h,i)=>{const V=o("el-text"),s=o("el-form-item"),S=o("el-input"),b=o("el-option"),I=o("el-select"),U=o("el-input-number"),R=o("el-image"),l=o("el-button"),W=o("el-form"),j=o("el-dialog");return p(),B("div",X,[e(j,{modelValue:$(f).show,"onUpdate:modelValue":i[3]||(i[3]=c=>$(f).show=c),title:a.value.parent.id===0?"创建分类":"添加子分类"},{footer:t(()=>[N("span",Z,[e(l,{onClick:v},{default:t(()=>[n("取消")]),_:1}),e(l,{type:"primary",onClick:r},{default:t(()=>[n("确定")]),_:1})])]),default:t(()=>[e(W,{model:a.value,ref_key:"formRef",ref:C,rules:g.value,"label-width":ee},{default:t(()=>[e(s,{label:"父级分类"},{default:t(()=>[e(V,{tag:"b"},{default:t(()=>[n(H(a.value.parent.name),1)]),_:1})]),_:1}),e(s,{label:"分类名称",prop:"name"},{default:t(()=>[e(S,{modelValue:a.value.name,"onUpdate:modelValue":i[0]||(i[0]=c=>a.value.name=c),clearable:""},null,8,["modelValue"])]),_:1}),e(s,{label:"状态",prop:"status"},{default:t(()=>[e(I,{modelValue:a.value.status,"onUpdate:modelValue":i[1]||(i[1]=c=>a.value.status=c),size:"default",placeholder:"选择状态"},{default:t(()=>[e(b,{label:"正常",value:"0"}),e(b,{label:"停用",value:"1"})]),_:1},8,["modelValue"])]),_:1}),e(s,{label:"排序",prop:"sort"},{default:t(()=>[e(U,{modelValue:a.value.sort,"onUpdate:modelValue":i[2]||(i[2]=c=>a.value.sort=c),size:"default","controls-position":"right"},null,8,["modelValue"])]),_:1}),e(s,{label:"图标",class:"el_form_item_cut_img"},{default:t(()=>[e(R,{class:"type_icon",src:a.value.icon},{error:t(()=>[Y]),_:1},8,["src"]),e(l,{onClick:k},{default:t(()=>[n("选择图片")]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"]),e(A,{dialog:d.value,onOnConfirm:T,"cut-width":100,"cut-height":100},null,8,["dialog"])])}}},ae=F(te,[["__scopeId","data-v-14b62c72"]]);const oe={class:"page"},le={class:"table_col_action"},ne={__name:"page-shop-type",setup(m){const D=z(),_=u(!0),w=u([]),f=M(()=>D.wh.h-90-40-42-42);P(()=>{x()});const x=()=>{_.value=!0,O.get("data/shopType.json").then(async r=>{await new Promise(v=>setTimeout(v,1e3)),w.value=r.data.data}).catch(r=>{console.error(r)}).finally(()=>{_.value=!1})},d=u({show:!1}),a=u({parent:{id:0,name:"无"},name:"",status:"0",sort:1,icon:""}),C=()=>{a.value.parent.id=0,a.value.parent.name="无",d.value.show=!0},k=r=>{a.value.parent.id=r.id,a.value.parent.name=r.name,d.value.show=!0},T=r=>{console.log("创建分类：--> "+r)};return(r,v)=>{const g=o("el-button"),h=o("el-row"),i=o("el-empty"),V=o("el-text"),s=o("el-table-column"),S=o("el-image"),b=o("el-tag"),I=o("el-table"),U=o("el-card"),R=Q("loading");return p(),B("div",oe,[G((p(),y(U,{shadow:"never",class:"vel_card_override"},{default:t(()=>[e(h,{style:{"margin-bottom":"10px"}},{default:t(()=>[e(g,{type:"primary",onClick:C},{default:t(()=>[n("创建分类")]),_:1})]),_:1}),e(I,{data:w.value,height:f.value,"row-key":"id","default-expand-all":""},{empty:t(()=>[e(i,{description:"暂无数据"})]),default:t(()=>[e(s,{prop:"name",label:"分类名称",width:"200"},{default:t(l=>[l.row.parent?(p(),y(V,{key:0,tag:"b"},{default:t(()=>[n(H(l.row.name),1)]),_:2},1024)):(p(),B(J,{key:1},[n(H(l.row.name),1)],64))]),_:1}),e(s,{prop:"icon",label:"图标",align:"center"},{default:t(l=>[e(S,{src:l.row.icon,style:{width:"50px",height:"50px"}},null,8,["src"])]),_:1}),e(s,{prop:"sort",label:"排序",align:"center"}),e(s,{label:"状态",align:"center"},{default:t(l=>[l.row.status===0?(p(),y(b,{key:0},{default:t(()=>[n("正常")]),_:1})):l.row.status===-1?(p(),y(b,{key:1,type:"info"},{default:t(()=>[n("停用")]),_:1})):q("",!0)]),_:1}),e(s,{label:"操作",fixed:"right","min-width":"200"},{default:t(l=>[N("div",le,[l.row.children?(p(),y(g,{key:0,type:"primary",plain:"",onClick:W=>k(l.row)},{default:t(()=>[n("添加子分类 ")]),_:2},1032,["onClick"])):q("",!0),e(g,{type:"success",plain:""},{default:t(()=>[n("编辑")]),_:1}),e(g,{type:"danger",plain:""},{default:t(()=>[n("删除")]),_:1})])]),_:1})]),_:1},8,["data","height"])]),_:1})),[[R,_.value]]),e(ae,{paramData:a.value,dialog:d.value,onOnConfirm:T},null,8,["paramData","dialog"])])}}},Ne=F(ne,[["__scopeId","data-v-bf8bf0b7"]]);export{Ne as default};
