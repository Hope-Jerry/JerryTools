import{u as z,i as O}from"../../assets/index-56aff382.js";import{I as A}from"../image-cutter-dialog/image-cutter-dialog.fcd61012.js";import{_ as H}from"../vue-img-cutter/vue-img-cutter.3d5e4c17.js";import{r as c,i as P,ah as o,o as p,c as B,W as e,Q as t,a as W,U as n,V as N,u as q,bi as E,bg as L,j as M,ar as Q,R as G,P as b,F as J,T as F}from"../@vue/@vue.5ea14220.js";import"../pinia/pinia.fb187a93.js";import"../vue-router/vue-router.6ed6991e.js";import"../localforage/localforage.9e9e3b2b.js";import"../@kangc/@kangc.f59435d2.js";import"../vue/vue.1c0a12e0.js";import"../js-cookie/js-cookie.edb2da2a.js";import"../axios/axios.47b9d439.js";import"../element-plus/element-plus.33c2f463.js";import"../lodash-es/lodash-es.21c98b27.js";import"../@vueuse/@vueuse.71e72d96.js";import"../@element-plus/@element-plus.99d8e261.js";import"../@popperjs/@popperjs.c75af06c.js";import"../@ctrl/@ctrl.f8748455.js";import"../dayjs/dayjs.10495895.js";import"../async-validator/async-validator.dee29e8b.js";import"../memoize-one/memoize-one.297ddbcb.js";import"../escape-html/escape-html.66262ebd.js";import"../normalize-wheel-es/normalize-wheel-es.ed76fb12.js";import"../@floating-ui/@floating-ui.72671fae.js";import"../echarts/echarts.3025caf6.js";import"../tslib/tslib.54e39b60.js";import"../zrender/zrender.7e5d4d80.js";import"../vue-echarts/vue-echarts.8b3ad32f.js";import"../resize-detector/resize-detector.a5205554.js";import"../nprogress/nprogress.d255c298.js";import"../highlight.js/highlight.js.84ca6879.js";const K=m=>(E("data-v-2bcaefbe"),m=m(),L(),m),X={class:"vel_cpt_panel_dialog_add_shop_type"},Y=K(()=>W("p",null,"预览",-1)),Z={class:"dialog-footer"},ee="100px",te={__name:"add-shop-type-dialog",props:["dialog","paramData"],emits:["onConfirm"],setup(m,{emit:D}){const _=m,w=D,f=_.dialog,x=_.paramData,d=c({show:!1}),a=c({parent:{id:0,name:"无"},status:"0",sort:1,name:"",icon:""}),C=c(null);P(()=>{a.value=x});const k=()=>{d.value.show=!0},T=h=>{a.value.icon=h.dataURL},r=async()=>{try{await C.value.validate(),w("onConfirm",a.value),v()}catch{console.log("表单验证未通过")}},v=()=>{f.show=!1,a.value.parent.id=0,a.value.parent.name="无",a.value.name="",a.value.icon="",a.value.status="0",a.value.sort=1},g=c({name:[{required:!0,message:"分类名称不能为空！",trigger:"blur"},{min:2,max:10,message:"长度在 2 到 10 个字符",trigger:"blur"}],status:[{required:!0,message:"请选择状态",trigger:"change"}],sort:[{required:!0,message:"请输入排序",trigger:"blur"}]});return(h,i)=>{const V=o("el-text"),s=o("el-form-item"),S=o("el-input"),y=o("el-option"),I=o("el-select"),U=o("el-input-number"),R=o("el-image"),l=o("el-button"),$=o("el-form"),j=o("el-dialog");return p(),B("div",X,[e(j,{modelValue:q(f).show,"onUpdate:modelValue":i[3]||(i[3]=u=>q(f).show=u),title:a.value.parent.id===0?"创建分类":"添加子分类"},{footer:t(()=>[W("span",Z,[e(l,{onClick:v},{default:t(()=>[n("取消")]),_:1}),e(l,{type:"primary",onClick:r},{default:t(()=>[n("确定")]),_:1})])]),default:t(()=>[e($,{model:a.value,ref_key:"formRef",ref:C,rules:g.value,"label-width":ee},{default:t(()=>[e(s,{label:"父级分类"},{default:t(()=>[e(V,{tag:"b"},{default:t(()=>[n(N(a.value.parent.name),1)]),_:1})]),_:1}),e(s,{label:"分类名称",prop:"name"},{default:t(()=>[e(S,{modelValue:a.value.name,"onUpdate:modelValue":i[0]||(i[0]=u=>a.value.name=u),clearable:""},null,8,["modelValue"])]),_:1}),e(s,{label:"状态",prop:"status"},{default:t(()=>[e(I,{modelValue:a.value.status,"onUpdate:modelValue":i[1]||(i[1]=u=>a.value.status=u),size:"default",placeholder:"选择状态"},{default:t(()=>[e(y,{label:"正常",value:"0"}),e(y,{label:"停用",value:"1"})]),_:1},8,["modelValue"])]),_:1}),e(s,{label:"排序",prop:"sort"},{default:t(()=>[e(U,{modelValue:a.value.sort,"onUpdate:modelValue":i[2]||(i[2]=u=>a.value.sort=u),size:"default","controls-position":"right"},null,8,["modelValue"])]),_:1}),e(s,{label:"图标",class:"el_form_item_cut_img"},{default:t(()=>[e(R,{class:"type_icon",src:a.value.icon},{error:t(()=>[Y]),_:1},8,["src"]),e(l,{onClick:k},{default:t(()=>[n("选择图片")]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"]),e(A,{dialog:d.value,onOnConfirm:T,"cut-width":100,"cut-height":100},null,8,["dialog"])])}}},ae=H(te,[["__scopeId","data-v-2bcaefbe"]]);const oe={class:"page"},le={class:"table_col_action"},ne={__name:"page-shop-type",setup(m){const D=z(),_=c(!0),w=c([]),f=M(()=>D.wh.h-90-40-42-42);P(()=>{x()});const x=()=>{_.value=!0,O.get("data/shopType.json").then(async r=>{await new Promise(v=>setTimeout(v,1e3)),w.value=r.data.data}).catch(r=>{console.error(r)}).finally(()=>{_.value=!1})},d=c({show:!1}),a=c({parent:{id:0,name:"无"},name:"",status:"0",sort:1,icon:""}),C=()=>{a.value.parent.id=0,a.value.parent.name="无",d.value.show=!0},k=r=>{a.value.parent.id=r.id,a.value.parent.name=r.name,d.value.show=!0},T=r=>{console.log("创建分类：--> "+r)};return(r,v)=>{const g=o("el-button"),h=o("el-row"),i=o("el-empty"),V=o("el-text"),s=o("el-table-column"),S=o("el-image"),y=o("el-tag"),I=o("el-table"),U=o("el-card"),R=Q("loading");return p(),B("div",oe,[G((p(),b(U,{shadow:"never",class:"vel_card_override"},{default:t(()=>[e(h,{style:{"margin-bottom":"10px"}},{default:t(()=>[e(g,{type:"primary",onClick:C},{default:t(()=>[n("创建分类")]),_:1})]),_:1}),e(I,{data:w.value,height:f.value,"row-key":"id","default-expand-all":""},{empty:t(()=>[e(i,{description:"暂无数据"})]),default:t(()=>[e(s,{prop:"name",label:"分类名称",width:"200"},{default:t(l=>[l.row.parent?(p(),b(V,{key:0,tag:"b"},{default:t(()=>[n(N(l.row.name),1)]),_:2},1024)):(p(),B(J,{key:1},[n(N(l.row.name),1)],64))]),_:1}),e(s,{prop:"icon",label:"图标",align:"center"},{default:t(l=>[e(S,{src:l.row.icon,style:{width:"50px",height:"50px"}},null,8,["src"])]),_:1}),e(s,{prop:"sort",label:"排序",align:"center"}),e(s,{label:"状态",align:"center"},{default:t(l=>[l.row.status===0?(p(),b(y,{key:0},{default:t(()=>[n("正常")]),_:1})):l.row.status===-1?(p(),b(y,{key:1,type:"info"},{default:t(()=>[n("停用")]),_:1})):F("",!0)]),_:1}),e(s,{label:"操作",fixed:"right","min-width":"200"},{default:t(l=>[W("div",le,[l.row.children?(p(),b(g,{key:0,type:"primary",plain:"",onClick:$=>k(l.row)},{default:t(()=>[n("添加子分类 ")]),_:2},1032,["onClick"])):F("",!0),e(g,{type:"success",plain:""},{default:t(()=>[n("编辑")]),_:1}),e(g,{type:"danger",plain:""},{default:t(()=>[n("删除")]),_:1})])]),_:1})]),_:1},8,["data","height"])]),_:1})),[[R,_.value]]),e(ae,{paramData:a.value,dialog:d.value,onOnConfirm:T},null,8,["paramData","dialog"])])}}},qe=H(ne,[["__scopeId","data-v-1337dbd0"]]);export{qe as default};
